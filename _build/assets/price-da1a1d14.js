import{$ as d,r as v,t as k,v as z,e as q,n as M,p as U,a as C,b as W,w as Y,k as x}from"./solid-4c629049.js";import{g as H}from"./products-773fb53a.js";import{d as D,u as N}from"./server-runtime-7cf80ad8.js";const _=Symbol("store-raw"),y=Symbol("store-node"),u=Symbol("store-has"),E=Symbol("store-self");function R(e){let n=e[d];if(!n&&(Object.defineProperty(e,d,{value:n=new Proxy(e,B)}),!Array.isArray(e))){const t=Object.keys(e),r=Object.getOwnPropertyDescriptors(e);for(let o=0,i=t.length;o<i;o++){const s=t[o];r[s].get&&Object.defineProperty(e,s,{enumerable:r[s].enumerable,get:r[s].get.bind(n)})}}return n}function S(e){let n;return e!=null&&typeof e=="object"&&(e[d]||!(n=Object.getPrototypeOf(e))||n===Object.prototype||Array.isArray(e))}function w(e,n=new Set){let t,r,o,i;if(t=e!=null&&e[_])return t;if(!S(e)||n.has(e))return e;if(Array.isArray(e)){Object.isFrozen(e)?e=e.slice(0):n.add(e);for(let s=0,f=e.length;s<f;s++)o=e[s],(r=w(o,n))!==o&&(e[s]=r)}else{Object.isFrozen(e)?e=Object.assign({},e):n.add(e);const s=Object.keys(e),f=Object.getOwnPropertyDescriptors(e);for(let c=0,g=s.length;c<g;c++)i=s[c],!f[i].get&&(o=e[i],(r=w(o,n))!==o&&(e[i]=r))}return e}function A(e,n){let t=e[n];return t||Object.defineProperty(e,n,{value:t=Object.create(null)}),t}function h(e,n,t){if(e[n])return e[n];const[r,o]=q(t,{equals:!1,internal:!0});return r.$=o,e[n]=r}function X(e,n){const t=Reflect.getOwnPropertyDescriptor(e,n);return!t||t.get||!t.configurable||n===d||n===y||(delete t.value,delete t.writable,t.get=()=>e[d][n]),t}function T(e){k()&&h(A(e,y),E)()}function p(e){return T(e),Reflect.ownKeys(e)}const B={get(e,n,t){if(n===_)return e;if(n===d)return t;if(n===v)return T(e),t;const r=A(e,y),o=r[n];let i=o?o():e[n];if(n===y||n===u||n==="__proto__")return i;if(!o){const s=Object.getOwnPropertyDescriptor(e,n);k()&&(typeof i!="function"||e.hasOwnProperty(n))&&!(s&&s.get)&&(i=h(r,n,i)())}return S(i)?R(i):i},has(e,n){return n===_||n===d||n===v||n===y||n===u||n==="__proto__"?!0:(k()&&h(A(e,u),n)(),n in e)},set(){return!0},deleteProperty(){return!0},ownKeys:p,getOwnPropertyDescriptor:X};function P(e,n,t,r=!1){if(!r&&e[n]===t)return;const o=e[n],i=e.length;t===void 0?(delete e[n],e[u]&&e[u][n]&&o!==void 0&&e[u][n].$()):(e[n]=t,e[u]&&e[u][n]&&o===void 0&&e[u][n].$());let s=A(e,y),f;if((f=h(s,n,o))&&f.$(()=>t),Array.isArray(e)&&e.length!==i){for(let c=e.length;c<i;c++)(f=s[c])&&f.$();(f=h(s,"length",i))&&f.$(e.length)}(f=s[E])&&f.$()}function K(e,n){const t=Object.keys(n);for(let r=0;r<t.length;r+=1){const o=t[r];P(e,o,n[o])}}function G(e,n){if(typeof n=="function"&&(n=n(e)),n=w(n),Array.isArray(n)){if(e===n)return;let t=0,r=n.length;for(;t<r;t++){const o=n[t];e[t]!==o&&P(e,t,o)}P(e,"length",r)}else K(e,n)}function O(e,n,t=[]){let r,o=e;if(n.length>1){r=n.shift();const s=typeof r,f=Array.isArray(e);if(Array.isArray(r)){for(let c=0;c<r.length;c++)O(e,[r[c]].concat(n),t);return}else if(f&&s==="function"){for(let c=0;c<e.length;c++)r(e[c],c)&&O(e,[c].concat(n),t);return}else if(f&&s==="object"){const{from:c=0,to:g=e.length-1,by:$=1}=r;for(let l=c;l<=g;l+=$)O(e,[l].concat(n),t);return}else if(n.length>1){O(e[r],n,[r].concat(t));return}o=e[r],t=[r].concat(t)}let i=n[0];typeof i=="function"&&(i=i(o,t),i===o)||r===void 0&&i==null||(i=w(i),r===void 0||S(o)&&S(i)&&!Array.isArray(i)?K(o,i):P(e,r,i))}function Q(...[e,n]){const t=w(e||{}),r=Array.isArray(t),o=R(t);function i(...s){z(()=>{r&&s.length===1?G(t,s[0]):O(t,s)})}return[o,i]}const V=(e,n)=>{if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const[t,r]of Object.entries(e))if(Object.hasOwn(n,t)===!1||r!==n[t])return!1;return!0},F=U(),re=e=>{const[n,t]=Z([],1),[r,o]=q(void 0),i=D(async l=>{const I=Number(l.get("id")),J=Number(l.get("quantity")),j=await H(I);if(j===void 0)throw new Error("Product not found");const L=Object.fromEntries(j.properties.map(a=>[a.name,l.get(`p_${a.name}`)])),b={product:j,quantity:J,variation:L};o(b),await new Promise(a=>setTimeout(a,1e3));const m=n.find(a=>a.product.id===b.product.id&&V(a.variation,b.variation));if(m){const a=n.indexOf(m);t(a,"quantity",m.quantity+b.quantity)}else t(n.length,b)},"add"),s=D(async()=>{await new Promise(l=>setTimeout(l,1e3)),t([])},"clear"),f=N(i),c=N(s),g=C(()=>f.pending===!0?"adding":c.pending===!0?"clearing":"idle"),$=C(()=>{switch(g()){case"adding":return r();case"clearing":return;case"idle":return}});return W(F.Provider,{value:{items:n,current:$,state:g,add:i,clear:s},get children(){return e.children}})},oe=()=>M(F);function Z(e,n){const[t,r]=Q(e),o=`cart.v${n}`;return Y(()=>{if(console.log(localStorage[o]),localStorage[o])try{r(JSON.parse(localStorage[o]))}catch{r(()=>e)}x(()=>{localStorage[o]=JSON.stringify(t)})}),[t,r]}function ie(e){return[{EUR:"€",USD:"$",JPY:"¥"}[e.value.currency]," ",C(()=>e.value.value)]}export{re as C,ie as P,oe as u};
