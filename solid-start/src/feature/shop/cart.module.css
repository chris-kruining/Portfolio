@layer component.layout {
    #btn {
        anchor-name: --cart-btn;
    }

    #cart {
        position: absolute;
        inset-inline-start: auto;
        inset-inline-end: auto;

        anchor-default: --cart-btn;
        anchor-scroll: --cart-btn;

        position-fallback: --fallback;

        @position-fallback --fallback {
            @try {
                inset-block-end: anchor(top);
                inset-inline-start: anchor(left);
            }

            @try {
                inset-block-start: anchor(bottom);
                inset-inline-end: anchor(right);
            }
        }

        &:popover-open {
            display: grid;
        }

        &>section {
            display: grid;
            grid-template-columns: 3em auto auto;

            &>div {
                grid-column: span 3;
                display: grid;
                grid-template-columns: subgrid;

                &>img {
                    grid-area: span 2 / 1;
                    inline-size: 100%;
                    aspect-ratio: 1;
                }

                &>strong {
                    min-inline-size: 5em;
                }

                &>ul {
                    grid-column: span 2;
                }
            }
        }
    }
}

@layer component.spacing {
    #btn {
        padding: var(--size-2) var(--size-3);
    }

    #cart {
        padding: var(--size-3);
        gap: var(--size-5);

        &>section {
            gap: var(--size-5);
            padding-block: var(--size-3);

            &>div {
                gap: var(--size-1) var(--size-2);


                &>ul {
                    margin: 0;
                }
            }
        }
    }
}

@layer component.animation {
    #cart {
        --time: .3s;
        transition:
            translate var(--time),
            opacity var(--time),
            overlay var(--time) allow-discrete,
            display var(--time) allow-discrete;
        transform-origin: top right;

        opacity: 0;
        translate: 25% 0;

        &:popover-open {
            translate: 0;
            opacity: 1;
        }
    }

    @starting-style {
        #cart:popover-open {
            opacity: 0;
            translate: 25% 0;
        }
    }
}

@layer component.theme {
    #cart {
        border: 1px solid transparent;
        border-radius: var(--radius-2);
        box-shadow: var(--shadow-3);

        &:global(.active) {
            border-color: var(--blue-5);
        }
    }
}